[
    {
      "name": "Scenario: ❌ return_direct, ❌ response_format, ❌ stop_when",
      "returnDirect": false,
      "responseFormat": null,
      "stopWhen": null,
      "expectedToolCalls": 10,
      "expectedLastMessage": "Attempts: 10",
      "expectedStructuredResponse": null
    },
    {
      "name": "Scenario: ❌ return_direct, ✅ response_format, ❌ stop_when",
      "returnDirect": false,
      "responseFormat": {
        "schema": {
          "type": "object",
          "properties": {
            "attempts": { "type": "number" },
            "succeeded": { "type": "boolean" }
          },
          "required": ["attempts", "succeeded"]
        }
      },
      "stopWhen": null,
      "expectedToolCalls": 10,
      "expectedLastMessage": "Returning structured response: {\"attempts\":10,\"succeeded\":true}",
      "expectedStructuredResponse": { "attempts": 10, "succeeded": true }
    },
    {
      "name": "Scenario: ❌ return_direct, ❌ response_format, ✅ stop_when",
      "returnDirect": false,
      "responseFormat": null,
      "stopWhen": [
        {
          "predicate": "stopWhenToolCall",
          "args": ["pollJob", 5]
        }
      ],
      "expectedToolCalls": 5,
      "expectedLastMessage": "A stop condition was met: Tool call count for pollJob is 5 and exceeded the limit of 5",
      "expectedStructuredResponse": null
    },
    {
      "name": "Scenario: ❌ return_direct, ✅ response_format, ✅ stop_when",
      "returnDirect": false,
      "responseFormat": {
        "schema": {
          "type": "object",
          "properties": {
            "attempts": { "type": "number" },
            "succeeded": { "type": "boolean" }
          },
          "required": ["attempts", "succeeded"]
        }
      },
      "stopWhen": [
        {
          "predicate": "stopWhenToolCall",
          "args": ["pollJob", 5]
        }
      ],
      "expectedToolCalls": 5,
      "expectedLastMessage": "A stop condition was met: Tool call count for pollJob is 5 and exceeded the limit of 5",
      "expectedStructuredResponse": { "attempts": 5, "succeeded": false }
    },
    {
      "name": "Scenario: ✅ return_direct, ❌ response_format, ❌ stop_when",
      "returnDirect": true,
      "responseFormat": null,
      "stopWhen": null,
      "expectedToolCalls": 1,
      "expectedLastMessage": "{\n  \"status\": \"pending\",\n  \"attempts\": 1\n}",
      "expectedStructuredResponse": null
    },
    {
      "name": "Scenario: ✅ return_direct, ✅ response_format, ❌ stop_when",
      "returnDirect": true,
      "responseFormat": {
        "schema": {
          "type": "object",
          "properties": {
            "attempts": { "type": "number" },
            "succeeded": { "type": "boolean" }
          },
          "required": ["attempts", "succeeded"]
        }
      },
      "stopWhen": null,
      "expectedToolCalls": 1,
      "expectedLastMessage": "{\n  \"status\": \"pending\",\n  \"attempts\": 1\n}",
      "expectedStructuredResponse": null
    },
    {
      "name": "Scenario: ✅ return_direct, ❌ response_format, ✅ stop_when",
      "returnDirect": true,
      "responseFormat": null,
      "stopWhen": [
        {
          "predicate": "stopWhenToolCall",
          "args": ["pollJob", 5]
        }
      ],
      "expectedToolCalls": 1,
      "expectedLastMessage": "{\n  \"status\": \"pending\",\n  \"attempts\": 1\n}",
      "expectedStructuredResponse": null
    },
    {
      "name": "Scenario: ✅ return_direct, ✅ response_format, ✅ stop_when",
      "returnDirect": true,
      "responseFormat": {
        "schema": {
          "type": "object",
          "properties": {
            "attempts": { "type": "number" },
            "succeeded": { "type": "boolean" }
          },
          "required": ["attempts", "succeeded"]
        }
      },
      "stopWhen": [
        {
          "predicate": "stopWhenToolCall",
          "args": ["pollJob", 5]
        }
      ],
      "expectedToolCalls": 1,
      "expectedLastMessage": "{\n  \"status\": \"pending\",\n  \"attempts\": 1\n}",
      "expectedStructuredResponse": null
    }
  ]